<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout :: common_header(~{::title})">
    <title>我的自选股-投资日记</title>
</head>
<body th:replace="layout :: common_body(~{::div.contain_content})">


<div class="contain_content">
    <script src="https://img.highcharts.com.cn/jquery/jquery-1.8.3.min.js"></script>
    <script src="https://img.highcharts.com.cn/highstock/highstock.js"></script>
    <script src="https://img.highcharts.com.cn/highcharts/modules/exporting.js"></script>
    <script src="https://img.highcharts.com.cn/highcharts-plugins/highcharts-zh_CN.js"></script>
    <script src="https://img.highcharts.com.cn/highcharts/modules/drag-panes.js"></script>
    <link href="http://img1.cache.netease.com/f2e/finance/gegu/s.1064000.css" rel="stylesheet" type="text/css"
          charset="utf-8">


    <div class="navbar has-shadow" style="position: relative; top: 1px;">
        <div class="container">
            <div class="navbar-tabs">
                <a href="#" class="navbar-item is-tab is-active">K线图</a>
                <a class="navbar-item is-tab" th:href="${'http://stockpage.10jqka.com.cn/'+ code}"
                   target="_blank">基本面</a>
                <a class="navbar-item is-tab" th:href="${'http://stockpage.10jqka.com.cn/'+code+'/field/#fieldstatus'}"
                   target="_blank">行业地位</a>
                <a class="navbar-item is-tab" th:href="${'/stock/analyse?code='+code}" target="_blank">股票诊断</a>
                <a class="navbar-item is-tab" th:href="${'/invest/list?code='+code}" target="_blank">持股</a>
                <!--<a href="#" class="navbar-item is-tab">专栏</a>-->
                <!--<a href="#" class="navbar-item is-tab">Live</a>-->
                <!--<a href="#" class="navbar-item is-tab">私家课</a>-->
                <!--<a href="#" class="navbar-item is-tab">电子书</a>-->
            </div>
        </div>
    </div>
    <div class="section">
        <div class="container">
            <div class="tile">
                <div class="tile is-vertical is-parent is-8">
                    <div class="">

                        <div class="media">
                            <script type="text/javascript" th:src="${'http://hq.sinajs.cn/list='+stock.ecode}"
                                    charset="gb2312">
                            </script>
                            <div class="stock_info">
                                <table>
                                    <tbody>
                                    <tr>
                                        <td class="col_1">
                                            <h1 class="name">
                                                <a href="/1300059.html">[[${name}]]</a>
                                                <span>(<a href="/1300059.html">[[${code}]]</a>)</span>
                                            </h1>
                                        </td>
                                        <td class="col_2">
                                            <div class="stock_detail">
                                                <table style="width:825px">
                                                    <tbody>
                                                    <tr>
                                                        <td class="price"><span
                                                                _ntesquote_="code:1300059;fmt:pic_updown;"
                                                                class="price_arrow up"><strong
                                                                _ntesquote_="code:1300059;attr:price;fixed:2;color:updown"
                                                                class=" cRed"><script>document.write(hq_str_[[${stock.ecode}]].split(",")[3])</script></strong></span><em
                                                                _ntesquote_="code:1300059;attr:updown;fixed:2;color:updown"
                                                                class=" cRed">0.72</em><br><em
                                                                _ntesquote_="code:1300059;attr:percent;percent:2;color:updown"
                                                                class=" cRed">3.74%</em>
                                                        </td>
                                                        <td>今开：<strong
                                                                _ntesquote_="code:1300059;attr:open;fixed:2;color:updown"
                                                                class=" cRed"><script>document.write(hq_str_[[${stock.ecode}]].split(",")[1])</script></strong><br>昨收：<strong
                                                                _ntesquote_="code:1300059;attr:yestclose;fixed:2;color:updown"
                                                                class=" cRed"><script>document.write(hq_str_[[${stock.ecode}]].split(",")[2])</script></strong></td>
                                                        <td>最高：<strong
                                                                _ntesquote_="code:1300059;attr:high;fixed:2;color:updown"
                                                                class=" cRed"><script>document.write(hq_str_[[${stock.ecode}]].split(",")[4])</script></strong><br>最低：<strong
                                                                _ntesquote_="code:1300059;attr:low;fixed:2;color:updown"
                                                                class=" cRed"><script>document.write(hq_str_[[${stock.ecode}]].split(",")[5])</script></strong></td>
                                                        <td>成交量：<strong
                                                                _ntesquote_="code:1300059;attr:volume;fmt:volume-cut">288.78万手</strong><br>成交额：<strong
                                                                _ntesquote_="code:1300059;attr:turnover;fmt:turnover-cut">56.08亿</strong>
                                                        </td>
                                                        <td>量比：<strong>0.93</strong><br>换手：<strong
                                                                _ntesquote_="code:1300059;fmt:huanshou;SCSTC27:516828.5026">5.59%</strong>
                                                        </td>

                                                    </tr>
                                                    <tr class="stock_bref">
                                                        <td><span _ntesquote_="code:1300059;attr:time"
                                                                  class="refresh_time">2019/03/18 15:59:36</span></td>
                                                        <td>流通市值：<span
                                                                _ntesquote_="code:1300059;fmt:stockmcap;SCSTC27:516828.5026">1,032亿</span>
                                                        </td>
                                                        <td title="市盈率=最新股价/最近四个季度每股收益之和">市盈率：<span
                                                                _ntesquote_="code:1300059;fmt:pe;MFSUM:0.1858">107.48</span>
                                                        </td>
                                                        <td>52周最高：<span class="cRed">22.88</span></td>
                                                        <td>52周最低：<span class="cGreen">10.03</span></td>

                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="box">
                        <div class="media">
                            <div class="media-content">
                                <div class="content">
                                    <div id="container" style="min-width:400px;height:600px">图表加载中...</div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="tile is-vertical is-parent">
                    <div class="card">
                        <div class="card-header">
                            <p class="card-header-title">相关结果</p>
                        </div>
                        <div class="card-content">
                            <div class="media">
                                <!--<div class="media-left">-->
                                <!--<figure class="image is-64x64">-->
                                <!--<img src="https://bulma.io/images/placeholders/128x128.png" alt="">-->
                                <!--</figure>-->
                                <!--</div>-->
                                <div class="media-content">
                                    <p>
                                        <strong>持股数量：[[${stock.quantity}]]</strong>
                                        <span class="tag is-gray">专栏</span></p>
                                    <p>
                                        1.6K 关注 | 12 篇文章
                                    </p>
                                </div>

                                <div class="media-content">
                                    <a target="_blank" class="button is-info" href="/invest/add">交易</a>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <p class="card-header-title">知乎热搜</p>
                        </div>
                        <div class="card-content">
                            <ul class="lh-20">
                                <li><a href="#">演员的诞生第十期</a><i class="fa fa-fire"></i></li>
                                <li><a href="#">北航陈小武</a><i class="fa fa-fire"></i></li>
                                <li><a href="#">微信跳一跳</a><i class="fa fa-fire"></i></li>
                                <li><a href="#">解忧杂货店</a></li>
                                <li><a href="#">前任3</a></li>
                                <li><a href="#">妖猫传</a></li>
                                <li><a href="#">琅琊榜2</a></li>
                                <li><a href="#">刘昊然</a></li>
                                <li><a href="#">黄轩</a></li>
                                <li><a href="#">比特币</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- container -->
    </div>


    <script>
        /*<![CDATA[*/
        /*]]>*/
        $(function () {
            Highcharts.setOptions({
                lang: {
                    rangeSelectorZoom: ''
                }
            });
            //https://data.jianshukeji.com/stock/history/000001
            $.getJSON('/stock/kdata/[[${code}]]', function (data) {
                if (data.code !== 1) {
                    alert('读取股票数据失败！');
                    return false;
                }
                data = data.data;
                var ohlc = [],
                    volume = [],
                    dataLength = data.length,
                    // set the allowed units for data grouping
                    groupingUnits = [
                        [
                            'week',                         // unit name
                            [1]                             // allowed multiples
                        ], [
                            'month',
                            [1, 2, 3, 4, 6]
                        ]],
                    i = 0;
                for (i; i < dataLength; i += 1) {
                    ohlc.push([
                        data[i][0], // the date
                        data[i][1], // open
                        data[i][2], // high
                        data[i][3], // low
                        data[i][4] // close
                    ]);
                    volume.push([
                        data[i][0], // the date
                        data[i][5] // the volume
                    ]);
                }
                // create the chart
                var chart = Highcharts.stockChart('container', {
                    rangeSelector: {
                        selected: 1,
                        inputDateFormat: '%Y-%m-%d'
                    },
                    title: {
                        text: '[[${name}]]历史股价'
                    },
                    xAxis: {
                        dateTimeLabelFormats: {
                            millisecond: '%H:%M:%S.%L',
                            second: '%H:%M:%S',
                            minute: '%H:%M',
                            hour: '%H:%M',
                            day: '%m-%d',
                            week: '%m-%d',
                            month: '%y-%m',
                            year: '%Y'
                        }
                    },
                    tooltip: {
                        split: false,
                        shared: true,
                    },
                    yAxis: [{
                        labels: {
                            align: 'right',
                            x: -3
                        },
                        title: {
                            text: '股价'
                        },
                        height: '65%',
                        resize: {
                            enabled: true
                        },
                        lineWidth: 2
                    }, {
                        labels: {
                            align: 'right',
                            x: -3
                        },
                        title: {
                            text: '成交量'
                        },
                        top: '65%',
                        height: '35%',
                        offset: 0,
                        lineWidth: 2
                    }],
                    series: [{
                        type: 'candlestick',
                        name: '[[${name}]]',
                        color: 'green',
                        lineColor: 'green',
                        upColor: 'red',
                        upLineColor: 'red',
                        tooltip: {},
                        navigatorOptions: {
                            color: Highcharts.getOptions().colors[0]
                        },
                        data: ohlc,
                        dataGrouping: {
                            units: groupingUnits
                        },
                        id: 'sz'
                    }, {
                        type: 'column',
                        data: volume,
                        yAxis: 1,
                        dataGrouping: {
                            units: groupingUnits
                        }
                    }]
                });
            });
        })

    </script>

</div>
</body>
</html>